---
title: "Amazon Q Developer のプロジェクトルールを活用しよう"
emoji: "📝"
type: "tech"
topics: ["aws", "amazonq"]
published: false
---

## はじめに

https://zenn.dev/ymotongpoo/articles/20250408-qdev-profile-beta

https://github.com/aws/amazon-q-developer-cli/pull/834

![](/images/20250508-amazonq-context/amazonq-context.drawio.png)

Amazon Q Developer を使っていると、「どうすれば自分のプロジェクトに最適な回答を得られるだろう？」と思うことがあります。特にチーム開発では、コーディング規約やアーキテクチャの一貫性が重要です。そこで役立つのが「プロジェクトルール」機能です。この記事では、Amazon Q Developer のプロジェクトルールについて、初めて使う方でも理解できるように解説します。

プロジェクトルールを活用することで、チームの規約に沿った回答を得られるようになり、コードの一貫性を保ちながら開発効率を向上させることができます。また、新しいメンバーがプロジェクトに参加した際の学習コストも削減できます。

## Amazon Q Developer とプロジェクトルール

Amazon Q Developer は AWS が提供する AI アシスタントで、コード生成、バグ修正、コードレビューなど、開発者の様々なタスクをサポートします。プロジェクトルールは、この AI アシスタントに対してプロジェクト固有のガイドラインを提供する機能です。

### プロジェクトルールとは

プロジェクトルールとは、Amazon Q Developer に対してプロジェクト固有の指示やガイドラインを提供する仕組みです。これらのルールは、`.amazonq/rules/` フォルダに保存され、自動的にすべてのチャットやインラインチャットのコンテキストに追加されます。

プロジェクトルールを設定することで、以下のようなメリットがあります：

-   チームのコーディング規約に沿った回答を得られる
-   アーキテクチャの一貫性を保てる
-   プロジェクト固有の制約を考慮した提案を受けられる
-   新しいメンバーがプロジェクトの方針を理解しやすくなる

## プロジェクトルールの設定方法

プロジェクトルールを設定するには、以下の手順に従います：

### ステップ 1: ルールディレクトリの作成

プロジェクトのルートディレクトリに `.amazonq/rules/` フォルダを作成します。

```bash
mkdir -p .amazonq/rules/
```

### ステップ 2: ルールファイルの作成

`.amazonq/rules/` フォルダ内に、Markdown 形式でルールファイルを作成します。ファイル名は任意ですが、内容を表す名前にすると管理しやすくなります。

例えば、コーディング規約を定義する `coding-standards.md` ファイルを作成する場合：

```bash
touch .amazonq/rules/coding-standards.md
```

### ステップ 3: ルールの記述

ルールファイルには、プロジェクト固有のガイドラインを明確に記述します。Markdown 形式で記述することで、見出しや箇条書きを使って構造化できます。

以下は、コーディング規約の例です：

```markdown
# コーディング規約

## 全般

-   インデントには 2 スペースを使用する
-   行の最大長は 100 文字とする
-   ファイル末尾には空行を 1 行入れる

## 命名規則

-   変数名はキャメルケース（例: userName）
-   クラス名はパスカルケース（例: UserService）
-   定数は大文字のスネークケース（例: MAX_RETRY_COUNT）

## コメント

-   関数には必ず JSDoc スタイルのコメントを付ける
-   複雑なロジックには説明コメントを追加する

## エラー処理

-   例外は具体的な型を使用する
-   エラーメッセージは明確で具体的にする
```

## プロジェクトルールの活用例

実際にプロジェクトルールがどのように活用できるか、いくつかの例を見てみましょう。

### 例 1: コーディング規約の適用

`.amazonq/rules/coding-standards.md` に以下のようなルールを定義しておきます：

```markdown
# コーディング規約

-   TypeScript を使用する
-   インデントは 2 スペース
-   セミコロンは使用しない
-   関数名はキャメルケース
-   インターフェース名は「I」プレフィックスを付けない
```

このルールを設定した状態で、Amazon Q Developer に新しい関数の作成を依頼すると：

```
ユーザーの入力を検証する関数を作成してください
```

Amazon Q Developer は、定義されたコーディング規約に従ったコードを生成します：

```typescript
// 入力検証関数
const validateUserInput = (input: string): ValidationResult => {
    const trimmedInput = input.trim();

    if (trimmedInput.length === 0) {
        return {
            isValid: false,
            error: "Input cannot be empty",
        };
    }

    // さらに検証ロジックを追加

    return {
        isValid: true,
    };
};

// 検証結果の型定義
type ValidationResult = {
    isValid: boolean;
    error?: string;
};
```

### 例 2: アーキテクチャガイドラインの適用

`.amazonq/rules/architecture.md` に以下のようなルールを定義しておきます：

```markdown
# アーキテクチャガイドライン

## レイヤー構造

-   プレゼンテーション層（controllers）
-   ビジネスロジック層（services）
-   データアクセス層（repositories）

## 依存関係

-   上位レイヤーは下位レイヤーに依存してよいが、その逆は不可
-   依存性注入を使用して結合度を下げる
-   リポジトリは直接データベースに依存してよいが、サービスは直接データベースに依存してはならない
```

このルールを設定した状態で、Amazon Q Developer に新しい機能の実装を依頼すると：

```
ユーザー登録機能を実装してください
```

Amazon Q Developer は、定義されたアーキテクチャガイドラインに従った実装を提案します：

```
アーキテクチャガイドラインに従って、ユーザー登録機能を以下のように実装します：

1. コントローラー層（プレゼンテーション層）
2. サービス層（ビジネスロジック層）
3. リポジトリ層（データアクセス層）

各ファイルの実装例を示します。
```

## プロジェクトルールのベストプラクティス

プロジェクトルールを効果的に活用するためのベストプラクティスをいくつか紹介します：

### 明確で具体的なルールを書く

抽象的な表現よりも、具体的な例を含めたルールの方が効果的です。

```markdown
# 良い例

-   変数名はキャメルケースで記述する（例: userName, isValid）
-   エラーメッセージは具体的に記述する（例: "ユーザー名は 3 文字以上必要です" など）

# 避けるべき例

-   良い変数名を使う
-   わかりやすいエラーメッセージを書く
```

### カテゴリ別にルールを整理する

ルールが多い場合は、カテゴリ別に整理すると理解しやすくなります。

```markdown
# フロントエンド規約

## コンポーネント

-   ...

## スタイリング

-   ...

## 状態管理

-   ...
```

### 理由や背景を説明する

ルールの理由や背景を説明することで、チームメンバーの理解が深まります。

```markdown
# テスト規約

-   各関数に単体テストを書く
    -   理由: バグの早期発見と機能の安全な変更を可能にするため
-   テストカバレッジは 80%以上を維持する
    -   理由: 完璧なカバレッジを目指すとコストが高くなるため、重要な部分をカバーする 80%を目標とする
```

### 定期的に見直す

プロジェクトの進行に合わせて、ルールを定期的に見直し、更新することが重要です。

## プロジェクトルールの実例

実際のプロジェクトでどのようなルールを定義するか、いくつかの実例を紹介します。

### コーディング規約の例

```markdown
# コーディング規約

## JavaScript/TypeScript

-   ES6 以降の機能を積極的に使用する
-   TypeScript の型は可能な限り明示的に指定する
-   any 型の使用は避ける
-   null より undefined を優先して使用する
-   非同期処理には async/await を使用する

## React

-   関数コンポーネントと Hooks を使用する
-   Props には型定義を必ず行う
-   コンポーネントは単一責任の原則に従う
-   大きなコンポーネントは小さなコンポーネントに分割する
```

### アーキテクチャガイドラインの例

```markdown
# アーキテクチャガイドライン

## バックエンド（Node.js + Express）

-   RESTful API の原則に従う
-   コントローラーは入力の検証とレスポンスの整形のみを担当
-   ビジネスロジックはサービス層に実装
-   データベースアクセスはリポジトリ層に実装
-   環境変数で設定を管理し、ハードコーディングしない

## フロントエンド（React）

-   Atomic Design パターンを採用
-   グローバル状態は Redux で管理
-   API クライアントは独立したモジュールとして実装
-   ルーティングは React Router を使用
```

### セキュリティガイドラインの例

```markdown
# セキュリティガイドライン

-   ユーザー入力は必ずサーバーサイドでバリデーションする
-   SQL インジェクション対策として ORM またはプリペアドステートメントを使用する
-   パスワードは bcrypt でハッシュ化する
-   JWT の有効期限は短く設定し、リフレッシュトークンを使用する
-   CSRF トークンを実装する
-   HTTPS を強制する
-   機密情報をログに出力しない
```

## さいごに

Amazon Q Developer のプロジェクトルール機能を活用することで、チームの規約に沿った一貫性のあるコードを効率的に生成できるようになります。特に複数人で開発するプロジェクトでは、コーディング規約やアーキテクチャの一貫性を保つために非常に役立ちます。

プロジェクトルールは単なる規約文書ではなく、AI アシスタントの振る舞いを直接制御する強力なツールです。チームの生産性向上のために、ぜひ活用してみてください。

ではでは。
